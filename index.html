<!DOCTYPE html>


<!--
 | Generated by Apache Maven Doxia Site Renderer 2.0.0-M19 from src/site/xdoc/index.xml at 25 Sep 2024
 | Rendered using Apache Maven Fluido Skin 2.0.0-M9
-->
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="generator" content="Apache Maven Doxia Site Renderer 2.0.0-M19" />
    <meta name="author" content="The MyBatis Team" />
    <title>MyBatis-Velocity – MyBatis Velocity</title>
    <link rel="stylesheet" href="./css/apache-maven-fluido-2.0.0-M9.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />
    <script src="./js/apache-maven-fluido-2.0.0-M9.min.js"></script>
  </head>
  <body>
    <div class="container-fluid container-fluid-top">
      <header>
        <div id="banner">
          <div class="pull-left"></div>
          <div class="pull-right"><div id="bannerRight"><h1><a href="https://blog.mybatis.org/" class="externalLink"><img class="imageLink" src="https://www.mybatis.org/images/mybatis-logo.png" alt="MyBatis logo" /> MyBatis</a></h1></div></div>
          <div class="clear"><hr/></div>
        </div>

        <div id="breadcrumbs">
          <ul class="breadcrumb">
        <li id="publishDate">Last Published: 25 Sep 2024<span class="divider">|</span>
</li>
          <li id="projectVersion">Version: 2.3.0</li>
          </ul>
        </div>
      </header>
      <div class="row-fluid">
        <header id="leftColumn" class="span2">
          <nav class="well sidebar-nav">
  <ul class="nav nav-list">
   <li class="nav-header">Documentation</li>
    <li class="active"><a>Quick start</a></li>
   <li class="nav-header">Project Documentation</li>
    <li><a href="project-info.html"><span class="icon-chevron-down"></span>Project Information</a>
     <ul class="nav nav-list">
      <li><a href="ci-management.html">CI Management</a></li>
      <li><a href="dependencies.html">Dependencies</a></li>
      <li><a href="dependency-info.html">Maven Coordinates</a></li>
      <li><a href="distribution-management.html">Distribution Management</a></li>
      <li class="active"><a>About</a></li>
      <li><a href="issue-management.html">Issue Management</a></li>
      <li><a href="licenses.html">Licenses</a></li>
      <li><a href="mailing-lists.html">Mailing Lists</a></li>
      <li><a href="plugin-management.html">Plugin Management</a></li>
      <li><a href="plugins.html">Plugins</a></li>
      <li><a href="scm.html">Source Code Management</a></li>
      <li><a href="summary.html">Summary</a></li>
      <li><a href="team.html">Team</a></li>
     </ul></li>
    <li><a href="project-reports.html"><span class="icon-chevron-right"></span>Project Reports</a></li>
  </ul>
          </nav>
          <div class="well sidebar-nav">
            <div id="poweredBy">
              <div class="clear"></div>
              <div class="clear"></div>
<a href="https://maven.apache.org/" class="builtBy" target="_blank"><img class="builtBy" alt="Built by Maven" src="./images/logos/maven-feather.png" /></a>
            </div>
          </div>
        </header>
        <main id="bodyColumn" class="span10">


  
    <section><a id="Introduction"></a>
<h1>Introduction</h1>
      
<p>
      mybatis-velocity is an extension that allows you to use the Apache Velocity scripting language
      to generate your dynamic SQL queries on the fly.
      </p>
      
<p>
        If you are not familiar with apache velocity, you can learn it from its documentation site:
      </p>
      
<ul>
        
<li>
          <a href="https://velocity.apache.org/engine/2.1/vtl-reference.html" class="externalLink">Velocity Template Language (VTL) Reference</a>
        </li>
      </ul>
    </section>

    <section><a id="Requirments"></a>
<h1>Requirments</h1>
      
<ul>
        
<li>Java : Java 8+</li>
        
<li>MyBatis : 3.5+</li>
        
<li>Velocity : 2.1+</li>
      </ul>
    </section>

    <section><a id="Install"></a>
<h1>Install</h1>
      
<p>
        If you are using maven, you can add this:
      </p>
      
<pre class="prettyprint"><code>
&lt;dependency&gt;
    &lt;groupId&gt;org.mybatis.scripting&lt;/groupId&gt;
    &lt;artifactId&gt;mybatis-velocity&lt;/artifactId&gt;
    &lt;version&gt;2.1.0&lt;/version&gt;
&lt;/dependency&gt;
</code></pre>

      
<p>If you are using gradle, you can use this snippet:</p>

      
<pre class="prettyprint"><code>
dependencies {
    compile(&quot;org.mybatis.scripting:mybatis-velocity:2.1.0&quot;)
}</code></pre>

    </section>

    <section><a id="Configuration"></a>
<h1>Configuration</h1>
      <section><a id="Common"></a>
<h2>Common</h2>
        
<p>
          By default, the <code>mybatis-velocity.properties</code> file create in your classpath.
        </p>
        
<ul>
          
<li>
            You can specify user defined custom directives to use on the Velocity template engine using the Velocity standard property(<code>runtime.custom_directives</code>).
            For details see the <a href="#User_Defined_Directives">&quot;User Defined Directives&quot;</a>.
            
<pre class="prettyprint"><code>
velocitySettings.runtime.custom_directives = com.example.directives.MyDirective
# or
runtime.custom_directives = com.example.directives.MyDirective
</code></pre>

            The <code>userdirective</code> property supported for keeping backward compatibility with old versions(2.0 or under).
            
<pre class="prettyprint"><code>
userdirective = com.example.directives.MyDirective
</code></pre>
          </li>
          
<li>
            You can specify user defined additional context attribute values that passed to template engine.
            For details see the <a href="#Additional_Context_Attributes">&quot;Additional Context Attributes&quot;</a>.
            
<pre class="prettyprint"><code>
# additionalContextAttributes.{name} = {value}
# 'additional-context-attributes' (kebab-case) can be used too
additionalContextAttributes.likeEscape = com.example.helpers.LikeEscape
additionalContextAttributes.masterCacheFacade = com.example.helpers.MasterCacheFacade
</code></pre>

            The <code>additional.context.attributes</code> property supported for keeping backward compatibility with old versions(2.0 or under).
            
<pre class="prettyprint"><code>
# Value format: {name}:{value}(,...)
additional.context.attributes = likeEscape:com.example.helpers.LikeEscape,masterCacheFacade:com.example.helpers.MasterCacheFacade
</code></pre>
          </li>
          
<li>
            You can configure the Velocity configuration as follow:
            About available setting name, please refer to <a href="https://velocity.apache.org/engine/2.1/configuration.html" class="externalLink">the reference documentation of Velocity</a>.
            
<pre class="prettyprint"><code>
# velocitySettings.{name} = {value}
# 'velocity-settings' (kebab-case) can be used too
velocitySettings.resource.default_encoding = Windows-31J
</code></pre>

            The <code>{name} = {value}</code> format(without prefixed 'velocitySettings') supported for keeping backward compatibility with old versions(2.0 or under).
            
<pre class="prettyprint"><code>
# This setting is same with 'velocitySettings.resource.default_encoding'
resource.default_encoding = Windows-31J
</code></pre>
          </li>
          
<li>
            Since 2.1.0, you can use an any properties file or encoding as follow:
            
<pre class="prettyprint"><code>
$ java -Dmybatis-velocity.config.file=mybatis-velocity_production.properties -Dmybatis-velocity.config.encoding=Windows-31J ...
</code></pre>
          </li>
        </ul>

      </section>
      <section><a id="Scripting_Language_Driver"></a>
<h2>Scripting Language Driver</h2>
        
<p>
          You may need to do next steps:</p>
        
<ul>
          
<li>Register the language driver alias in your mybatis configuration file:
            
<pre class="prettyprint"><code>
&lt;configuration&gt;
  ...
  &lt;typeAliases&gt;
    &lt;typeAlias alias=&quot;velocity&quot; type=&quot;org.mybatis.scripting.velocity.VelocityLanguageDriver&quot;/&gt;
  &lt;/typeAliases&gt;
  ...
&lt;/configuration&gt;</code></pre>
          </li>
          
<li>Set the velocity as your default scripting language:
            
<pre class="prettyprint"><code>
&lt;configuration&gt;
  ...
  &lt;settings&gt;
      &lt;setting name=&quot;defaultScriptingLanguage&quot; value=&quot;velocity&quot;/&gt;
  &lt;/settings&gt;
  ...
&lt;/configuration&gt;</code></pre>
          </li>
        </ul>
      </section>
    </section>

    <section><a id="Usage"></a>
<h1>Usage</h1>
      
<p>Just write your dynamic queries and use velocity:</p>
      
<p>Example:
      </p>
<pre class="prettyprint"><code>
&lt;select id=&quot;findPerson&quot; lang=&quot;velocity&quot;&gt;
  #set( $pattern = $_parameter.name + '%' )
  SELECT *
  FROM person
  WHERE name LIKE @{pattern, jdbcType=VARCHAR}
&lt;/select&gt;
      </code></pre>
      
      
<p>
        Note:
      </p>
      
<ul>
        
<li><code>#{...}</code> syntax is replaced by <code>@{...}</code> syntax to avoid collisions with VTL</li>
      </ul>
    </section>
    <section><a id="Custom_directives"></a>
<h1>Custom directives</h1>
      <section><a id="trim"></a>
<h2>trim</h2>
        <section>
        </main>
      </div>
    </div>
    <hr/>
    <footer>
      <div class="container-fluid">
        <div class="row-fluid">
            <p>©      2012–2024
<a href="https://www.mybatis.org/">MyBatis.org</a>
</p>
        </div>
      </div>
    </footer>
<script>
  if(anchors) {
    anchors.add();
  }
</script>
  </body>
</html>